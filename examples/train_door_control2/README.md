# Train Door Control System (Reference Implementation 2)

**SIL Level**: 3  
**Current Phase**: Component Implementation and Testing (Phase 5)  
**Completion**: 25% (13 of 53 components tested)  
**Status**: IN PROGRESS - Completing MOD-002 to MOD-008 unit testing

---

## Quick Start

```bash
cd examples/train_door_control2
make all           # Build
make test          # Run unit tests
make coverage      # Generate coverage report
```

---

## Project Overview

This is a reference implementation of a railway train door control system developed according to EN 50128:2011 standards at SIL 3 (Safety Integrity Level 3).

**System Context**: Controls opening/closing of train doors with safety interlocks, emergency override, and obstacle detection. Critical safety function for passenger railway operations.

**Safety Requirements**: SIL 3 - Tolerable Hazard Rate (THR) ≤ 10⁻⁷ per hour per hazard. Implements defensive programming, redundant checks, and fail-safe design patterns.

---

## Current Status

<!-- ⚠️ AUTO-GENERATED SECTION: Do NOT edit manually -->
<!-- Generated by COD from LIFECYCLE_STATE.md -->
<!-- Last updated: 2026-02-24 -->

### Phase Progress

- [x] **Phase 0: Initialization** - Complete (2026-02-18)
- [x] **Phase 1: Planning** - PASSED - All planning documents approved (2026-02-18)
- [x] **Phase 2: Requirements** - PASSED - 50 requirements (46 SIL 3, 4 SIL 0), 100% traceability (2026-02-19)
- [x] **Phase 3: Architecture & Design** - PASSED - 8 modules, 0 defects (2026-02-21)
- [x] **Phase 4: Component Design** - PASSED - 53 components designed, complexity ≤10 (2026-02-22)
- [ ] **Phase 5: Component Implementation & Testing** - IN PROGRESS (25%) - MOD-001 complete, MOD-002-008 pending (40 components)
- [ ] **Phase 6: Integration** - BLOCKED - Awaiting Phase 5 completion
- [ ] **Phase 7: Validation** - Not Started
- [ ] **Phase 8: Assessment** - Not Started (Required SIL 3-4)
- [ ] **Phase 9: Deployment** - Not Started

### Recent Activity

**2026-02-24**: Phase 5 status corrected - IN PROGRESS (25% complete, 40 components remain)
**2026-02-22**: MOD-001 unit testing complete (100% MC/DC coverage achieved)
**2026-02-22**: Phase 4 gate check PASSED (12/12 criteria, 0 defects)  
**2026-02-21**: Phase 3 gate check PASSED (12/12 criteria, 0 defects)  
**2026-02-19**: Phase 2 gate check PASSED (15/15 criteria, 0 defects)

### Next Steps

**Priority Actions for Phase 5 (Component Implementation & Testing)**:
1. **Complete Unit Testing MOD-002 to MOD-008** (40 components remaining)
   - MOD-002: Sensor Interface (6 components)
   - MOD-003: Emergency Control (6 components)
   - MOD-004: Obstacle Detection (5 components)
   - MOD-005: Interlocks (5 components)
   - MOD-006: Diagnostics (4 components)
   - MOD-007: Communication Interface (5 components)
   - MOD-008: Redundancy Management (9 components)
2. **Achieve 100% MC/DC Coverage** (SIL 3 MANDATORY - statement/branch/condition coverage)
3. **Run QA Code Review** after all unit tests complete
4. **Submit to VER for verification** after QA approval
5. **Phase 5 Gate Check** - ALL components must be tested before gate passage (SIL 3 strict mode)

**SIL 3 Strict Gatekeeper Policy**: PARTIAL PASS is NOT allowed. Phase 5 gate will be BLOCKED until all 53 components have 100% MC/DC coverage.

<!-- END AUTO-GENERATED SECTION -->

---

## Documentation

### Lifecycle Tracking
- **[LIFECYCLE_STATE.md](LIFECYCLE_STATE.md)** - Detailed lifecycle status (Single Source of Truth)

### Requirements & Design
- [Software Requirements Specification](docs/Software-Requirements-Specification.md) - 50 requirements (DOC-SRS-2026-001)
- [Software Architecture Specification](docs/Software-Architecture-Specification.md) - 8 modules (DOC-ARCH-2026-001)
- [Software Design Specification](docs/Software-Design-Specification.md) - Module interfaces (DOC-DES-2026-001)
- [Software Component Design Specification](docs/Software-Component-Design-Specification.md) - 53 components (DOC-COMPDES-2026-001)
- [Requirements Traceability Matrix](docs/Requirements-Traceability-Matrix.md) - Embedded in SRS
- [Hazard Log](docs/Hazard-Log.md) - 8 hazards, 20 failure modes (DOC-HAZLOG-2026-001)

### Planning Documents
- [Software Quality Assurance Plan (SQAP)](docs/plans/SQAP.md)
- [Software Configuration Management Plan (SCMP)](docs/plans/SCMP.md)
- [Software Verification Plan (SVP)](docs/plans/SVP.md)
- [Software Validation Plan (SVaP)](docs/plans/SVaP.md)

### System Documents (EN 50126/50129)
- [System Document Guide](docs/system/README.md)
- [System Requirements Specification](docs/system/System-Requirements-Specification.md)
- [System Architecture Description](docs/system/System-Architecture-Description.md)
- [System Safety Plan](docs/system/System-Safety-Plan.md)
- [System Safety Requirements Specification](docs/system/System-Safety-Requirements-Specification.md)

---

## Build and Test

### Build Source Code
```bash
cd src/
make all           # Build static library
make clean         # Clean build artifacts
```

### Run Unit Tests
```bash
cd test/
make test          # Build and run tests
make coverage      # Generate coverage report (gcov/lcov)
```

### Static Analysis
```bash
make check         # Run cppcheck
make complexity    # Analyze cyclomatic complexity (lizard)
```

---

## Architecture

**System Design**: 8 safety-critical modules with defensive programming and fail-safe patterns.

**Modules**: 8  
**Components**: 53  
**Max Complexity**: ≤10 per function (SIL 3 limit: 10)

### Module Breakdown
- **MOD-001**: Door Control State Machine (13 components) - ✅ TESTED
- **MOD-002**: Sensor Interface (6 components) - ⏳ PENDING
- **MOD-003**: Emergency Control (6 components) - ⏳ PENDING
- **MOD-004**: Obstacle Detection (5 components) - ⏳ PENDING
- **MOD-005**: Interlocks (5 components) - ⏳ PENDING
- **MOD-006**: Diagnostics (4 components) - ⏳ PENDING
- **MOD-007**: Communication Interface (5 components) - ⏳ PENDING
- **MOD-008**: Redundancy Management (9 components) - ⏳ PENDING

---

## Safety Considerations

**SIL Level**: 3 (High integrity - low probability of dangerous failure)

### Key Safety Measures
- ✅ Static memory allocation only (no malloc/free)
- ✅ Cyclomatic complexity ≤ 10 (SIL 3 compliant)
- ✅ 100% defensive programming (NULL checks, range validation)
- ✅ MISRA C:2012 compliance
- ✅ Redundant safety checks
- ✅ Fail-safe error handling

### Safety Analysis
- **Hazards Identified**: 8 (see [Hazard Log](docs/Hazard-Log.md))
- **FMEA**: 20 failure modes analyzed
- **FTA**: 2 fault trees created
- **Common Cause Failures**: 4 scenarios analyzed

---

## Testing

### Coverage Requirements (SIL 3)
- Statement Coverage: 100% (MANDATORY)
- Branch Coverage: 100% (MANDATORY)
- Condition Coverage: 100% (MC/DC - MANDATORY)

### Current Test Statistics
- **Unit Tests**: 29 test cases (MOD-001 only)
- **Coverage Achieved**: 100% statement/branch/condition (MOD-001)
- **Integration Tests**: Not started
- **System Tests**: Not started
- **Test Pass Rate**: 100% (for completed modules)

### Testing Status by Module
- MOD-001: ✅ 29/29 tests passing (100% MC/DC coverage)
- MOD-002 to MOD-008: ⏳ Unit testing pending (40 components)

---

## License and Disclaimers

**License**: Educational / Reference Implementation

### Safety Disclaimer

⚠️ **IMPORTANT**: This is a reference implementation for educational purposes.

**Do NOT use in production safety-critical railway systems without**:
1. Complete safety assessment by independent assessor (EN 50128 Section 6.4)
2. Formal verification and validation (EN 50128 Sections 6.2, 7.7)
3. Target hardware testing and WCET analysis
4. Safety Authority approval
5. Compliance with all applicable railway standards:
   - EN 50126:2017 (RAMS - Reliability, Availability, Maintainability, Safety)
   - EN 50128:2011 (Railway Software)
   - EN 50129:2018 (Safety-related electronic systems for signalling)

This software is provided "AS IS" without warranty of any kind.

---

## Support

### Platform Documentation
- [EN50128 Platform README](../../README.md) - Platform overview
- [Lifecycle Guide](../../LIFECYCLE.md) - V-Model phases and deliverables
- [Agent Reference](../../AGENTS.md) - Role-based agents
- [Tutorial](../../TUTORIAL.md) - Step-by-step walkthrough

### Getting Help
- **Current Status**: Review [LIFECYCLE_STATE.md](LIFECYCLE_STATE.md)
- **Detailed Phase Info**: Run `/cod status`
- **Workspace Summary**: Run `/ws status`
- **Agent Commands**: Run `/enhelp` for all available commands

---

**Last Updated**: 2026-02-24  
**Generated From**: LIFECYCLE_STATE.md (Single Source of Truth)
